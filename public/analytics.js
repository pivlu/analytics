var ns_domain=window.location.hostname.replace("www.",""),userAgent=navigator.userAgent,referrer=window.frames.top.document.referrer,title=document.title,tracking_id=crypto.randomUUID(),serverURL=window.location.hostname,screenHeight=window.screen.height,screenWidth=window.screen.width;if(void 0===(ns_site=document.querySelector("script[data-site]").dataset.site))var ns_site=null;var isErrorPage=null;function sendAnalyticEvent(e,t){let n={site:ns_site,tracking_id:e,scroll_percent:t,domain:ns_domain,page:window.location.pathname,referrer:referrer,userAgent:userAgent,title:title,screenHeight:screenHeight,screenWidth:screenWidth,isErrorPage:isErrorPage};fetch(`${serverURL}/analytic-event`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),keepalive:!0})}function sendTimeEvent(e,t){let n={site:ns_site,tracking_id:e,seconds_min:t};fetch(`${serverURL}/time-event`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),keepalive:!0})}function startTracking(){TimeTrack.initialize({idleTimeoutInSeconds:310}),TimeTrack.callAfterTimeElapsedInSeconds(8,(function(){sendTimeEvent(tracking_id,10)})),TimeTrack.callAfterTimeElapsedInSeconds(28,(function(){sendTimeEvent(tracking_id,30)})),TimeTrack.callAfterTimeElapsedInSeconds(58,(function(){sendTimeEvent(tracking_id,60)})),TimeTrack.callAfterTimeElapsedInSeconds(118,(function(){sendTimeEvent(tracking_id,120)})),TimeTrack.callAfterTimeElapsedInSeconds(178,(function(){sendTimeEvent(tracking_id,180)})),TimeTrack.callAfterTimeElapsedInSeconds(298,(function(){sendTimeEvent(tracking_id,300)})),sendAnalyticEvent(tracking_id,0),["scroll"].forEach((e=>document.addEventListener(e,r)));var e=new scrollPercent,t=0,n=0,i=0;function r(r){var o=e.init();o>=25&&o<50&&!n&&!i&&0==t&&(sendAnalyticEvent(tracking_id,o),t++),o>=50&&o<75&&!i&&0==n&&(sendAnalyticEvent(tracking_id,o),n++),o>=75&&0==i&&(sendAnalyticEvent(tracking_id,o),i++)}}document.querySelectorAll('script[data-pivlu-analytics-error="1"]').length>0&&(isErrorPage=1),function(){var e,t;e=this,t=function(){var e={startStopTimes:{},idleTimeoutMs:3e4,currentIdleTimeMs:0,checkStateRateMs:250,active:!1,idle:!1,currentPageName:"current-page",timeElapsedCallbacks:[],userLeftCallbacks:[],userReturnCallbacks:[],trackTimeOnElement:function(t){var n=document.getElementById(t);n&&(n.addEventListener("mouseover",(function(){e.startTimer(t)})),n.addEventListener("mousemove",(function(){e.startTimer(t)})),n.addEventListener("mouseleave",(function(){e.stopTimer(t)})),n.addEventListener("keypress",(function(){e.startTimer(t)})),n.addEventListener("focus",(function(){e.startTimer(t)})))},getTimeOnElementInSeconds:function(t){return e.getTimeOnPageInSeconds(t)||0},startTimer:function(t,n){if(t||(t=e.currentPageName),void 0===e.startStopTimes[t])e.startStopTimes[t]=[];else{var i=e.startStopTimes[t],r=i[i.length-1];if(void 0!==r&&void 0===r.stopTime)return}e.startStopTimes[t].push({startTime:n||new Date,stopTime:void 0}),e.active=!0},stopAllTimers:function(){for(var t=Object.keys(e.startStopTimes),n=0;n<t.length;n++)e.stopTimer(t[n])},stopTimer:function(t){t||(t=e.currentPageName);var n=e.startStopTimes[t];void 0!==n&&0!==n.length&&(void 0===n[n.length-1].stopTime&&(n[n.length-1].stopTime=new Date),e.active=!1)},getTimeOnCurrentPageInSeconds:function(){return e.getTimeOnPageInSeconds(e.currentPageName)},getTimeOnPageInSeconds:function(t){return void 0===e.getTimeOnPageInMilliseconds(t)?void 0:e.getTimeOnPageInMilliseconds(t)/1e3},getTimeOnCurrentPageInMilliseconds:function(){return e.getTimeOnPageInMilliseconds(e.currentPageName)},getTimeOnPageInMilliseconds:function(t){var n=e.startStopTimes[t];if(void 0!==n){for(var i=0,r=0;r<n.length;r++){var o=n[r].startTime,s=n[r].stopTime;void 0===s&&(s=new Date),i+=s-o}return Number(i)}},getTimeOnAllPagesInSeconds:function(){for(var t=[],n=Object.keys(e.startStopTimes),i=0;i<n.length;i++){var r=n[i],o=e.getTimeOnPageInSeconds(r);t.push({pageName:r,timeOnPage:o})}return t},setIdleDurationInSeconds:function(t){var n=parseFloat(t);if(!1!==isNaN(n))throw{name:"InvalidDurationException",message:"Invalid time"};return e.idleTimeoutMs=1e3*t,this},setCurrentPageName:function(t){return e.currentPageName=t,this},resetRecordedPageTime:function(t){delete e.startStopTimes[t]},resetAllRecordedPageTimes:function(){for(var t=Object.keys(e.startStopTimes),n=0;n<t.length;n++)e.resetRecordedPageTime(t[n])},resetIdleCountdown:function(){e.idle&&e.triggerUserHasReturned(),e.idle=!1,e.currentIdleTimeMs=0},callWhenUserLeaves:function(e,t){this.userLeftCallbacks.push({callback:e,numberOfTimesToInvoke:t})},callWhenUserReturns:function(e,t){this.userReturnCallbacks.push({callback:e,numberOfTimesToInvoke:t})},triggerUserHasReturned:function(){if(!e.active)for(var t=0;t<this.userReturnCallbacks.length;t++){var n=this.userReturnCallbacks[t],i=n.numberOfTimesToInvoke;(isNaN(i)||void 0===i||0<i)&&(n.numberOfTimesToInvoke-=1,n.callback())}e.startTimer()},triggerUserHasLeftPage:function(){if(e.active)for(var t=0;t<this.userLeftCallbacks.length;t++){var n=this.userLeftCallbacks[t],i=n.numberOfTimesToInvoke;(isNaN(i)||void 0===i||0<i)&&(n.numberOfTimesToInvoke-=1,n.callback())}e.stopAllTimers()},callAfterTimeElapsedInSeconds:function(t,n){e.timeElapsedCallbacks.push({timeInSeconds:t,callback:n,pending:!0})},checkState:function(){for(var t=0;t<e.timeElapsedCallbacks.length;t++)e.timeElapsedCallbacks[t].pending&&e.getTimeOnCurrentPageInSeconds()>e.timeElapsedCallbacks[t].timeInSeconds&&(e.timeElapsedCallbacks[t].callback(),e.timeElapsedCallbacks[t].pending=!1);!1===e.idle&&e.currentIdleTimeMs>e.idleTimeoutMs?(e.idle=!0,e.triggerUserHasLeftPage()):e.currentIdleTimeMs+=e.checkStateRateMs},visibilityChangeEventName:void 0,hiddenPropName:void 0,listenForVisibilityEvents:function(){void 0!==document.hidden?(e.hiddenPropName="hidden",e.visibilityChangeEventName="visibilitychange"):void 0!==document.mozHidden?(e.hiddenPropName="mozHidden",e.visibilityChangeEventName="mozvisibilitychange"):void 0!==document.msHidden?(e.hiddenPropName="msHidden",e.visibilityChangeEventName="msvisibilitychange"):void 0!==document.webkitHidden&&(e.hiddenPropName="webkitHidden",e.visibilityChangeEventName="webkitvisibilitychange"),document.addEventListener(e.visibilityChangeEventName,(function(){document[e.hiddenPropName]?e.triggerUserHasLeftPage():e.triggerUserHasReturned()}),!1),window.addEventListener("blur",(function(){e.triggerUserHasLeftPage()})),window.addEventListener("focus",(function(){e.triggerUserHasReturned()})),document.addEventListener("mousemove",(function(){e.resetIdleCountdown()})),document.addEventListener("keyup",(function(){e.resetIdleCountdown()})),document.addEventListener("touchstart",(function(){e.resetIdleCountdown()})),window.addEventListener("scroll",(function(){e.resetIdleCountdown()})),setInterval((function(){e.checkState()}),e.checkStateRateMs)},websocket:void 0,websocketHost:void 0,setUpWebsocket:function(t){if(window.WebSocket&&t){var n=t.websocketHost;try{e.websocket=new WebSocket(n),window.onbeforeunload=function(){e.sendCurrentTime(t.appId)},e.websocket.onopen=function(){e.sendInitWsRequest(t.appId)},e.websocket.onerror=function(e){console&&console.log("Error occurred in websocket connection: "+e)},e.websocket.onmessage=function(e){console&&console.log(e.data)}}catch(t){console&&console.error("Failed to connect to websocket host.  Error:"+t)}}return this},websocketSend:function(t){e.websocket.send(JSON.stringify(t))},sendCurrentTime:function(t){var n={type:"INSERT_TIME",appId:t,timeOnPageMs:e.getTimeOnCurrentPageInMilliseconds(),pageName:e.currentPageName};e.websocketSend(n)},sendInitWsRequest:function(t){var n={type:"INIT",appId:t};e.websocketSend(n)},initialize:function(t){var n=e.idleTimeoutMs||30,i=e.currentPageName||"default-page-name",r=void 0,o=void 0;t&&(n=t.idleTimeoutInSeconds||n,i=t.currentPageName||i,r=t.websocketOptions,o=t.initialStartTime),e.setIdleDurationInSeconds(n).setCurrentPageName(i).setUpWebsocket(r).listenForVisibilityEvents(),e.startTimer(void 0,o)}};return e},"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],(function(){return e.TimeTrack=t()})):e.TimeTrack=t()}.call(this);var scrollPercent=function(){"use strict";var e;return{init:function(){var t=this.getWindowHeight(),n=this.getDocHeight()-t;return e=t/n*100,this.percent()},percent:function(){var t=this.getWindowHeight(),n=this.getDocHeight()-t,i=(this.getScrollPosition()+t)/n*100-e;return Math.floor(i)},getScrollPosition:function(){return void 0!==window.scrollY?window.scrollY:(document.documentElement||document.body.parentNode||document.body).scrollTop},getWindowHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0},getDocHeight:function(){return Math.max(document.body.scrollHeight||0,document.documentElement.scrollHeight||0,document.body.offsetHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0,document.documentElement.clientHeight||0)}}};setTimeout(startTracking,2e3);